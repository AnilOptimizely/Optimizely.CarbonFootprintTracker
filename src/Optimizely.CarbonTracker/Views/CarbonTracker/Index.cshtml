<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Footprint Tracker</title>
    <link rel="stylesheet" href="/carbon-tracker-assets/carbon-tracker/styles.css" />
</head>
<body>
    <div class="container">
        <!-- Loading State with skeleton shimmer -->
        <div id="loading" class="loading">
            <div class="skeleton skeleton-circle"></div>
            <div class="skeleton skeleton-line short"></div>
            <div class="skeleton skeleton-line short"></div>
            <div class="skeleton skeleton-bar"></div>
            <div>Analyzing page carbon footprint...</div>
        </div>

        <!-- Error State -->
        <div id="error" class="error" style="display: none;"></div>

        <!-- Not Published State -->
        <div id="notPublished" class="not-published" style="display: none;">
            <div class="not-published-icon">ðŸ“„</div>
            <div>No published version available.</div>
            <div style="font-size:12px;color:#aaa;margin-top:4px;">Publish the page to see its carbon footprint.</div>
        </div>

        <!-- Report Content -->
        <div id="report" style="display: none;">
            <!-- Section A: Green Score Badge -->
            <div class="score-badge">
                <div class="score-circle" id="scoreCircle">
                    <svg width="120" height="120">
                        <circle class="score-circle-bg" cx="60" cy="60" r="54"></circle>
                        <circle class="score-circle-fill" cx="60" cy="60" r="54"
                                stroke-dasharray="339.292" stroke-dashoffset="339.292" id="scoreProgress"></circle>
                    </svg>
                    <div class="score-letter" id="scoreLetter">-</div>
                </div>
                <div class="score-details">Estimated COâ‚‚ per page view</div>
                <div class="score-co2" id="scoreCO2">0g</div>
                <div class="comparison" id="scoreComparison"></div>
            </div>

            <!-- Section B: Asset Breakdown -->
            <div class="asset-breakdown">
                <h3 class="section-title">Asset Breakdown</h3>
                <div class="asset-bar" id="assetBar"></div>
                <div class="asset-legend" id="assetLegend"></div>
            </div>

            <!-- Section C: Optimization Suggestions (accordion) -->
            <div class="suggestions">
                <h3 class="section-title">Optimization Suggestions</h3>
                <div id="suggestionsList"></div>
            </div>

            <!-- Section D: Historical Trend Sparkline -->
            <div class="trend-section">
                <h3 class="section-title">Trend (Last 30 Days)</h3>
                <div class="sparkline-container" id="sparklineContainer">
                    <div class="no-history">Loading history...</div>
                </div>
            </div>

            <!-- Section E: Action Buttons -->
            <div class="actions">
                <button class="btn btn-primary" id="btnReanalyze">ðŸ”„ Re-analyze</button>
                <button class="btn btn-secondary" id="btnExport">ðŸ“¥ Export CSV</button>
            </div>
            <div class="actions" style="margin-top:8px;">
                <a class="btn btn-link" href="/api/carbon-tracker/site-summary" target="_blank">ðŸ“Š Full Dashboard</a>
            </div>
        </div>
    </div>

    <script>
        // Pass server-side values to client JS
        window.__carbonTracker_contentLink = '@ViewBag.ContentLink';
        window.__carbonTracker_pageUrl = '@ViewBag.PageUrl';
    </script>
    <script src="/carbon-tracker-assets/carbon-tracker/app.js"></script>
</body>
</html>
